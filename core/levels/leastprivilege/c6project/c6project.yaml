imports:
- path: service_account.jinja
- path: iam_policy.jinja
- path: bucket_acl.jinja
{% block imports %}{% endblock %}

resources:
- name: c6-access
  type: service_account.jinja

- name: c6-check
  type: service_account.jinja

- name: c6-bucket
  type: bucket_acl.jinja
  properties:
    nonce: {{ nonce }}
    predefined_acl: private
    
- name: c6-instance
  type: ubuntu_vm.jinja
  properties:
    zone: us-west1-b
    open_external: true

- name: iam_policy
  type: iam_policy.jinja
  properties:
    bindings:
    - service_account_id: c6-access
      role:
        name: roles/owner



    - service_account_id: c6-check
      role:
        name: custom
        custom_nonce: {{ nonce }}
        permissions:
        - iam.roles.get
        
{% block resources %}{% endblock %}

